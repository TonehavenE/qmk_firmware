#include QMK_KEYBOARD_H
#include "mousekey.h"
//#include "features/casemodes.h"
//#include "features/combo.h"

#define KC_NP KC_NO // key is not present
#define KC_NA KC_NO // present but not available for use
#define KC_NU KC_NO // available but not used
#define XXX KC_NO // Blank

// non-KC_ keycodes
#define KC_RST RESET

#define _BASE 0
#define _NAVR 1
#define _MOUR 2
#define _FUNL 3
#define _NSL 4
#define _NSSL 5

enum custom_keycodes {
  CAPSWORD = SAFE_RANGE,
  CAMELCASE,
  SLASHCASE,
  SNAKECASE,
  BASE,
  NAVR,
  MOUR,
  FUNL,
  NSL,
  NSSL,
};

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
  
  [_BASE] = LAYOUT(
  //,------+----------------+------------------+--------------+--------------+--------+----------------.        ,------------------------------------------------------+--------+--------+--------+--------+--------+--------.
     XXX,  KC_Q          , KC_W        ,  KC_F        ,     KC_P        ,  KC_G,    KC_LPRN,                      KC_RPRN,  KC_J, KC_L        , KC_U        , KC_Y          , KC_QUOT  ,  XXX,
  //|------+----------------+------------------+--------------+--------------+--------+----------------|        |------------------------------------------------------+--------+--------+--------+--------+--------+--------|
     XXX,  KC_A          , LALT_T(KC_R),  LCTL_T(KC_S),     LSFT_T(KC_T),  KC_D,    KC_LBRC,                      KC_RBRC,  KC_H, RSFT_T(KC_N), RCTL_T(KC_E), RALT_T(KC_I)  , KC_O     ,  XXX,
  //|------+----------------+------------------+--------------+--------------+--------+----------------|        |------------------------------------------------------+--------+--------+--------+--------+--------+--------|
     XXX,  LT(FUNL, KC_Z), ALGR_T(KC_X),  KC_C        ,     KC_V        ,  KC_B,    LT(_MOUR, KC_SPC),             XXX,      KC_K, KC_M        , KC_COMM     , ALGR_T(KC_DOT), KC_SLSH  ,  XXX,
  //|------+-----+----------+------------------+--------------------------------------+----------------|        |------------------------------------------------------+--------+--------+--------+--------+--------+--------|
     XXX,  CAPSWORD      , SLASHCASE   ,       LT(_NSSL, KC_TAB), LT(_NAVR, KC_ENT),  LT(_MOUR, KC_SPC),             XXX,      LT(_NSL, KC_BSPC),   XXX         , SNAKECASE, CAMELCASE,  XXX
  //`--------+--------+--------+--------+--------+--------+-------------------------------------------/          \--------+-----------------------------------------------------+--------+--------+--------+--------+--------'
  ),

  [_NAVR] = LAYOUT(
  //,------+----------------+------------------+--------------+--------------+--------+----------------.        ,------------------------------------------------------+--------+--------+--------+--------+--------+--------.
     XXX,  KC_RST , KC_NA  , KC_NA  , KC_NA  , KC_NA,    XXX,                                                     XXX,        KC_AGIN,  KC_UNDO, KC_UP  , KC_COPY,  XXX     ,  XXX,
  //|------+----------------+------------------+--------------+--------------+--------+----------------|        |------------------------------------------------------+--------+--------+--------+--------+--------+--------|
     XXX,  KC_LGUI, KC_LALT, KC_LCTL, KC_LSFT, KC_NA,    XXX,                                                     XXX,        KC_CAPS,  KC_LEFT, KC_DOWN, KC_RIGHT, KC_RIGHT,  XXX,
  //|------+----------------+------------------+--------------+--------------+--------+----------------|        |------------------------------------------------------+--------+--------+--------+--------+--------+--------|
     XXX,  KC_LGUI, KC_ALGR, KC_NA  , KC_NA  , KC_NA,    XXX,                                                  KC_DEL,    XXX    ,  KC_HOME, KC_PGDN, KC_PGUP,  KC_RIGHT,  XXX,
  //|------+-----+----------+------------------+--------------------------------------+----------------|        |------------------------------------------------------+--------+--------+--------+--------+--------+--------|
     XXX,  KC_NA  , XXX    , KC_NA  ,          KC_NA,    XXX,                                                  KC_DEL,    XXX    ,            KC_END , XXX    ,   XXX   ,  XXX
  //`--------+--------+--------+--------+--------+--------+-------------------------------------------/          \--------+-----------------------------------------------------+--------+--------+--------+--------+--------'
  ),

  [_MOUR] = LAYOUT(
 
  //,------+----------------+------------------+--------------+--------------+--------+----------------.        ,------------------------------------------------------+--------+--------+--------+--------+--------+--------.
     XXX,  KC_RST,         KC_NA,             KC_NA,         KC_NA,         KC_NA,    XXX,                       XXX,     KC_NU  , KC_WH_U, KC_MS_U,  KC_WH_D, KC_NU  , XXX,
  //|------+----------------+------------------+--------------+--------------+--------+----------------|        |------------------------------------------------------+--------+--------+--------+--------+--------+--------|
     XXX,  KC_A,           LALT_T(KC_R),      LCTL_T(KC_S),  LSFT_T(KC_T),          KC_NA,    XXX,               XXX,     KC_NU  , KC_MS_L, KC_MS_D,  KC_MS_R, XXX    , XXX,
  //|------+----------------+------------------+--------------+--------------+--------+----------------|        |------------------------------------------------------+--------+--------+-------+--------+--------+--------|
     XXX,  KC_A,           KC_ALGR,           KC_NA,         KC_NA,         KC_NA,    KC_NA,                     KC_BTN1, KC_NU  , KC_WH_L, KC_WH_U,  KC_WH_D, KC_WH_R, XXX,
  //|------+-----+----------+------------------+--------------------------------------+----------------|        |------------------------------------------------------+--------+--------+--------+--------+--------+--------|
     XXX,  XXX,  XXX,       KC_NA,                            KC_NA,                   KC_NA,                     KC_BTN1, KC_BTN2, KC_BTN3, XXX,            XXX,          XXX
  //`--------+--------+--------+--------+--------+--------+-------------------------------------------/          \--------+-----------------------------------------------------+--------+--------+--------+--------+--------'
  ),


  [_FUNL] = LAYOUT(
 
  //,------+----------------+------------------+--------------+--------------+--------+----------------.        ,------------------------------------------------------+--------+--------+--------+--------+--------+--------.
     XXX,  KC_F12,            KC_F7,           KC_F8,         KC_F9,         KC_PSCR,    XXX,                       XXX,       KC_NA,     KC_NA,           KC_NA,          KC_NA,          KC_RST ,           XXX,
  //|------+----------------+------------------+--------------+--------------+--------+----------------|        |------------------------------------------------------+--------+--------+--------+--------+--------+--------|
     XXX,  KC_F11,            KC_F4,           KC_F5,         KC_F6,         KC_SLCK,    XXX,                       XXX,       KC_NA,     KC_LSFT,         KC_RCTL,        KC_RALT,        KC_RGUI  ,         XXX,
  //|------+----------------+------------------+--------------+--------------+--------+----------------|        |------------------------------------------------------+--------+--------+--------+--------+--------+--------|
     XXX,  XXX   ,            KC_F1,           KC_F2,         KC_F3,         KC_PAUS,    XXX,                    KC_NA,     KC_NA,     KC_NA,           KC_NA,          KC_ALGR,       KC_RGUI,           XXX,
  //|------+-----+----------+------------------+--------------------------------------+----------------|        |------------------------------------------------------+--------+--------+--------+--------+--------+--------|
     XXX,  XXX,  XXX,        KC_APP,                        KC_SPC,                       XXX,                    KC_NA,     KC_NA,     KC_NA,           XXX,            XXX,             XXX
  //`--------+--------+--------+--------+--------+--------+-------------------------------------------/          \--------+-----------------------------------------------------+--------+--------+--------+--------+--------'
  ),

 [_NSL] = LAYOUT(
 
  //,------+----------------+------------------+--------------+--------------+--------+----------------.        ,------------------------------------------------------+--------+--------+--------+--------+--------+--------.
     XXX,  KC_LBRC,  KC_7,  KC_8,  KC_9,  KC_RBRC,  XXX    ,                    XXX,       KC_NA,     KC_NA,           KC_NA,          KC_NA,          KC_RST,           XXX,
  //|------+----------------+------------------+--------------+--------------+--------+----------------|        |------------------------------------------------------+--------+--------+--------+--------+--------+--------|
     XXX,  KC_SCLN,  KC_4,  KC_5,  KC_6,  KC_EQL ,  XXX    ,                    XXX,       KC_NA,     KC_LSFT,         KC_RCTL,        KC_RALT,        KC_RGUI,         XXX,
  //|------+----------------+------------------+--------------+--------------+--------+----------------|        |------------------------------------------------------+--------+--------+--------+--------+--------+--------|
     XXX,  KC_GRV ,  KC_1,  KC_2,  KC_3,  KC_BSLS,  KC_MINS,                    KC_NA,     KC_NA,     KC_NA,           KC_NA,          KC_ALGR,        KC_RGUI,           XXX,
  //|------+-----+----------+------------------+--------------------------------------+----------------|        |------------------------------------------------------+--------+--------+--------+--------+--------+--------|
     XXX,  XXX    ,  XXX,          KC_DOT, KC_0  ,  KC_MINS,                    KC_NA,     KC_NA,     KC_NA,           XXX,            XXX,             XXX
  //`--------+--------+--------+--------+--------+--------+-------------------------------------------/          \--------+-----------------------------------------------------+--------+--------+--------+--------+--------'
  ),

 [_NSSL] = LAYOUT(
 
  //,------+----------------+------------------+--------------+--------------+--------+----------------.        ,------------------------------------------------------+--------+--------+--------+--------+--------+--------.
     XXX,  KC_LCBR,    KC_AMPR,          KC_ASTR,      KC_LPRN,          KC_RCBR,    XXX,                       XXX,       KC_NA,     KC_NA,           KC_NA,          KC_NA,          KC_RST,           XXX,
  //|------+----------------+------------------+--------------+--------------+--------+----------------|        |------------------------------------------------------+--------+--------+--------+--------+--------+--------|
     XXX,  KC_COLN,     KC_DLR,          KC_PERC,       KC_CIRC,         KC_PLUS,    XXX,                       XXX,       KC_NA,     KC_LSFT,         KC_LCTL,        KC_LALT,        KC_RGUI,         XXX,
  //|------+----------------+------------------+--------------+--------------+--------+----------------|        |------------------------------------------------------+--------+--------+--------+--------+--------+--------|
     XXX,  KC_TILD,     KC_EXLM,         KC_AT,         KC_PIPE,         KC_PIPE,    KC_UNDS,                    KC_NA,     KC_NA,     KC_NA,           KC_NA,          KC_ALGR,        KC_RGUI,           XXX,
  //|------+-----+----------+------------------+--------------------------------------+----------------|        |------------------------------------------------------+--------+--------+--------+--------+--------+--------|
     XXX,  XXX    ,  XXX,   KC_GT,           KC_RPRN,                                    KC_UNDS,                    KC_NA,     KC_NA,     KC_NA,           XXX,            XXX,             XXX
  //`--------+--------+--------+--------+--------+--------+-------------------------------------------/          \--------+-----------------------------------------------------+--------+--------+--------+--------+--------'
  )
};
bool process_record_user(uint16_t keycode, keyrecord_t *record) {
    // Process case modes
    if (!process_case_modes(keycode, record)) {
        return false;
    }

    // Regular user keycode case statement
    switch (keycode) {
        case CAPSWORD:
            if (record->event.pressed) {
                toggle_caps_word();
            }
            return false;
        case SNAKECASE:
            // Turn spaces into _, e.g., this_is_how_it_would_look
            if (record->event.pressed) {
                enable_xcase_with(KC_UNDS);
            }
            return false;
         case SLASHCASE:
            // Turn spaces into / e.g. this/is/how/it/would/look
            if (record->event.pressed) {
                enable_xcase_with(KC_SLSH);
            }
            return false;
         case CAMELCASE:
            // Turn spaces into shifting the next key, e.g., thisIsHowItWouldLook
            if (record->event.pressed) {
                enable_xcase_with(OSM(MOD_LSFT));
            }
            return false;

        default:
            return true;  // Process all other keycodes normally
    }
}
